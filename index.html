<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <title>♥청첩장♥</title>
  <link href='./css/main.css' rel='stylesheet' type='text/css'>
</head>

<body>
<canvas id="my_canvas"></canvas>
</body>

<script>
  window.onload = function() {
    init(); // 캔버스 초기화

    background()
    .then(invation) // 배경
    .then(friend_ground) // 친구 땅
    .then(friend) // 친구
    .then(choice_box); // 초이스 박스
  };

  function init() {
    window.canvas = document.getElementById("my_canvas");

    window.canvas.width  = window.innerWidth;
    window.canvas.height = window.innerHeight;

    window.ctx = canvas.getContext('2d');
  }

  // 배경
  function background() {
    return new Promise((resolve, reject) => {
      let img = new Image();
      img.src = './img/background.png';
      img.onload = function() {
        window.ctx.drawImage(img, 0, 0, window.innerWidth, window.innerHeight);
        resolve();
      }
    });
  }

  // 초대장
  function invation() {
    return new Promise((resolve, reject) => {
      let img = new Image();
      img.src = './img/unit_invation.png';
      img.onload = function() {
        window.ctx.drawImage(img, window.innerWidth - img.width - 10, 90);
        resolve();
      }
    });
  }

  // 친구 땅
  function friend_ground() {
    return new Promise((resolve, reject) => {
      let img = new Image();
      img.src = './img/unit_friend_ground.png';
      img.onload = function() {
        window.ctx.drawImage(img, 0, 250);
        resolve();
      }
    });
  }

  // 친구
  function friend() {
    return new Promise((resolve, reject) => {
      let img = new Image();
      img.src = './img/unit_friend.png';
      img.onload = function() {
        window.ctx.drawImage(img, 40, 176);
        resolve();
      }
    });
  }

  // 선택박스
  function choice_box() {
    return new Promise((resolve, reject) => {
      let startHeight = 267;
      let sideWidth = 19;
      let sideHeight = 13;

      let nine_1 = () => {
        return new Promise((resolve, reject) => {
          let img1 = new Image();
          img1.src = './img/nine_1.png';
          img1.onload = function() {
            window.ctx.drawImage(img1, 0, startHeight);
            console.log('nine_1 done');
            resolve();
          }
        });
      };

      let nine_3 = () => {
        return new Promise((resolve, reject) => {
          let img3 = new Image();
          img3.src = './img/nine_3.png';
          img3.onload = function() {
            window.ctx.drawImage(img3, window.canvas.width - img3.width, startHeight);
            console.log('nine_3 done');
            resolve();
          }
        });
      };
      
      let nine_7 = () => {
        return new Promise((resolve, reject) => {
          let img7 = new Image();
          img7.src = './img/nine_7.png';
          img7.onload = function() {
            window.ctx.drawImage(img7, 0, window.innerHeight - 13);
            console.log('nine_7 done');
            resolve();
          }
        });
      };
      
      let nine_9 = () => {
        return new Promise((resolve, reject) => {
          let img9 = new Image();
          img9.src = './img/nine_9.png';
          img9.onload = function() {
            window.ctx.drawImage(img9, window.canvas.width - img9.width, window.innerHeight - 13);
            console.log('nine_9 done');
            resolve();
          }
        });
      };

      let nine_2 = () => {
        return new Promise((resolve, reject) => {
          let img2 = new Image();
          img2.src = './img/nine_2.png';
          img2.onload = function() {
            let startX = sideWidth;
            let endX = window.innerWidth - sideWidth;
            for (i = startX; i < endX; i++) {
              window.ctx.drawImage(img2, i, startHeight);
            }
            console.log('nine_2 done');
            resolve();
          }
        });
      };

      let nine_8 = () => {
        return new Promise((resolve, reject) => {
          let img8 = new Image();
          img8.src = './img/nine_8.png';
          img8.onload = function() {
            let startX = sideWidth;
            let endX = window.innerWidth - sideWidth;
            for (i = startX; i < endX; i++) {
              window.ctx.drawImage(img8, i, window.innerHeight - 13);
            }
            console.log('nine_8 done');
            resolve();
          }
        });
      };

      let nine_4 = () => {
        return new Promise((resolve, reject) => {
          let img4 = new Image();
          img4.src = './img/nine_4.png';
          img4.onload = function() {
            let startY = startHeight + sideHeight;
            let endY = window.innerHeight - sideHeight;
            for (i = startY; i < endY; i++) {
              window.ctx.drawImage(img4, 0, i);
            }
            console.log('nine_4 done');
            resolve();
          }
        });
      };

      let nine_6 = () => {
        return new Promise((resolve, reject) => {
          let img6 = new Image();
          img6.src = './img/nine_6.png';
          img6.onload = function() {
            let startY = startHeight + sideHeight;
            let endY = window.innerHeight - sideHeight;
            for (i = startY; i < endY; i++) {
              window.ctx.drawImage(img6, window.canvas.width - sideWidth, i);
            }
            console.log('nine_6 done');
            resolve();
          }
        });
      };

      let rect = () => {
        window.ctx.rect(
          sideWidth,
          startHeight + sideHeight,
          window.innerWidth - (sideWidth * 2),
          window.innerHeight - startHeight - (sideHeight * 2)
        );

        window.ctx.fillStyle = '#285068';
        window.ctx.fill();
        console.log('rect done');
      };

      nine_1()
      .then(nine_2)
      .then(nine_3)
      .then(nine_4)
      .then(nine_6)
      .then(nine_7)
      .then(nine_8)
      .then(nine_9)
      .then(() => {
        rect();
        resolve();
      });
    });
  }

</script>
</html>